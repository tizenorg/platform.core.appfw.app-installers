SET(LIBNAME_COMMON ${TARGET_LIBNAME_COMMON})
PROJECT(${LIBNAME_COMMON} CXX)

SET(SRCS
	src/AppInstaller.cxx
#	src/step/step-unzip.cxx
)

pkg_check_modules(COMMON_DEPS REQUIRED pkgmgr pkgmgr-parser pkgmgr-info pkgmgr-installer libxml-2.0 libzip)
FOREACH(flag ${COMMON_DEPS_LIBRARIES})
	SET(COMMON_DEPS_LIB "${COMMON_DEPS_LIB} -l${flag}")
ENDFOREACH(flag)
FOREACH(flag ${COMMON_DEPS_CFLAGS})
	SET(EXTRA_CFLAGS "${EXTRA_CFLAGS} ${flag}")
ENDFOREACH(flag)

# Make libraries
ADD_LIBRARY(${LIBNAME_COMMON} SHARED ${SRCS})
TARGET_LINK_LIBRARIES(${LIBNAME_COMMON} ${COMMON_DEPS_LIB_LDFLAGS})
SET_TARGET_PROPERTIES(${LIBNAME_COMMON} PROPERTIES COMPILE_FLAGS "${EXTRA_CFLAGS}")
SET_TARGET_PROPERTIES(${LIBNAME_COMMON} PROPERTIES PREFIX "")
SET_TARGET_PROPERTIES(${LIBNAME_COMMON} PROPERTIES VERSION ${VERSION})
SET_TARGET_PROPERTIES(${LIBNAME_COMMON} PROPERTIES SOVERSION ${VERSION_MAJOR})

# Install
INSTALL(TARGETS ${LIBNAME_COMMON} DESTINATION ${LIB_INSTALL_DIR})

